---
layout: post
title: 图像的相关概念
subtitle:  opencv与计算机视觉
date: 2017-03-01 09:09:37 +08:00
author:     "VernonSong"
header-img: "img/post-bg-color.jpg"
catalog: true
tags:
    - C++
    - OpenCV
---
# 前言
因为项目的原因，要学习一些图像处理相关的知识，把matlab程序中图像处理的算法用C++写出来。不过因为对图像处理比较感兴趣，图形学的一些基本概念自己也比较了解，不敢说乘风破浪，硕果累累，但也是披荆斩棘，收获颇多。

# 正文
## 图像中的一些概念
### 点阵图
点阵图，也叫做位图（Bitmap），栅格图（Raster graphics），像素图。构成点阵图的最小单位是象素，位图就是由象素阵列的排列来实现其显示效果的，每个象素有自己的颜色信息，在对位图图像进行编辑操作的时候，可操作的对象是每个象素，我们可以改变图像的色相、饱和度、明度，从而改变图像的显示效果。点阵图缩放会失真，就像在30寸大显示器上全屏以最低分辨率玩游戏那种仿佛能看到颗粒的感觉。

### 矢量图
矢量图，也叫做向量图。矢量图并不纪录画面上每一点的信息，而是纪录了元素形状及颜色的算法，当你打开一付矢量图的时候，软件对图形象对应的函数进行运算，将运算结果[图形的形状和颜色]显示给你看。无论显示画面是大还是小，画面上的对象对应的算法是不变的，所以，即使对画面进行倍数相当大的缩放，其显示效果仍然相同(不失真)。

### 通道
通道这个概念说起来感觉就比较复杂，它在PS里经常能见到，我的理解就是它是用来表示图像某一属性的矩阵，矩阵的每个点代表图片的每个点。
![](https://github.com/VernonSong/Storage/blob/master/image/channel.jpg?raw=true)

从PS中可以很直观的看到，图的R，G，B三色通道所表现的值与我们了解的RGB光学三原色一致。除了RGB通道，常见的还有alpha通道，它保存的是透明度。

### 深度
深度是指存储每个像素所用的位数，它决定了图像每个像素可能的颜色数（或灰度级数等），比如每个像素有RGB三个分量，每个分量用8位，那么一个像素就需要24位来表示它，这个像素的深度即为24，有2的24次方种颜色。

### 索引色
索引色（Index Color）是计算机表示颜色的一种形式，即用一个数字来代表（索引）一种颜色，在存储图片的时候，存储一个数字的组合，同时存储数字到图片颜色的映射。这种方式只能存储有限种颜色，通常是256种颜色，对应到计算机系统中，使用一个字节的数字来索引一种颜色。

### 直接色
使用四个数字来代表一种颜色，这四个数字分别代表这个颜色中红色、绿色、蓝色以及透明度。现在流行的显示设备可以在这四个维度分别支持256种变化，所以直接色可以表示2的32次方种颜色。当然并非所有的直接色都支持这么多种，为压缩空间使用，有可能只有表达红、绿、蓝的三个数字，每个数字也可能不支持256种变化之多。

## 图像文件格式
在电脑中，我们能看到各种各样格式的图片后缀名，其中最广泛的莫过于jpg和png，自己以前处理完图片也会纠结，保存成什么格式比较好，其实这些在了解了每个格式的特性后，就不难抉择。

### PNG
PNG的全名为便携式网络图形（Portable Network Graphics，PNG），是一种无损压缩的位图图形格式，支持索引、灰度、RGB三种颜色方案以及Alpha通道等特性。PNG的开发目标是改善并替换GIF作为适合网络传输的格式而不需专利许可，所以被广泛应用于互联网及其他方面上。对于一些图片尺寸小，色彩层次不丰富的情况，或是文本，线条或类似边缘清晰，有着大块相同颜区域的图像，使用PNG是很好的选择。

### JPEG(JPG)
JPEG（发音为jay-peg, IPA：[ˈdʒeɪpɛg]）是一种针对照片视频而广泛使用的一种有损压缩标准方法。JPEG本身只有描述如何将一个视频转换为字节的数据流（streaming），但并没有说明这些字节如何在任何特定的存储媒体上被封存起来。JPEG的压缩方式通常是破坏性数据压缩（lossy compression），意即在压缩过程中图像的质量会遭受到可见的破坏。但是，因为这种压缩方法是针对照片图像专门设立的，适合于低对比度，图像颜色过渡平滑，噪声多，且结构不规则的情况，这时如果用PNG代替JPEG，不仅文件尺寸会大很多，对图像质量的提高也比较有限。

我们现在看到的很多都是JPG，其实两者一样，因DOS、Windows 95等早期系统采用的8.3命名规则只支持最长3字符的扩展名，为了兼容采用了JPG。也因历史习惯和兼容性考虑，JPG目前更流行。

## 图片数据结构

### Mat
Mat即矩阵（Matrix）的缩写，是OpenCV中的最基本的数据结构，Mat数据结构主要包含2部分：Header和Pointer。Header中主要包含矩阵的大小，存储方式，存储地址等信息；Pointer中存储指向像素值的指针。做为OpenCV提供的成熟的数据结构，它可以对内存进行动态管理，使用起来非常方便。这里不深究Mat的特性，只是罗列一下构造一个Mat类时，所常用的参数是什么。

Mat(int _rows, int _cols, int _type, void* _data, size_t _step)

rows和cols是矩阵的行数和列数，这里注意如果以图像来理解，那么rows就是图像的高，cols就是图像的宽。type是图片的格式，有CV_8UC1,CV_32FC3等等，这里8U，32F代表使用什么数据类型来存储:

- 8U unsigned char
- 8S char
- 16U unsigned short int
- 16S short int
- 32S int
- 32F float
- 64F double

后面的C是channel，C1就是1个通道，他们共同决定图片的Mat将怎样存储一张图片。

data就是图像色像素数据，需要注意的是step，虽然可能平时不会显式的设定它，但要知道它是Mat矩阵中每一行的“步长”，以字节为基本单位，是每一行中所有元素的字节总量，在有些时候，在构造时给它设定合适的值能防止图片在类型转化过程中发生变形。

### Bitmap
Bitmap是C#中用来存储图片的数据结构，它的定义在System.Drawing命名空间中，同Mat一样，它也是包含了存储图片的信息的头和存储图片数据的身体，它的像素类型是[PixelFormat](https://msdn.microsoft.com/zh-cn/library/system.drawing.imaging.pixelformat(v=vs.110).aspx)，MSDN中介绍的很详细。

部分内容援引自[赵鑫在知乎上的回答](https://www.zhihu.com/question/20028452/answer/142593276)