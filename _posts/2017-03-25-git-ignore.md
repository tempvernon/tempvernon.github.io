---
layout: post
title: .gitignore的使用
subtitle:  git小知识
date: 2017-2-15 09:09:37 +08:00
author:     "VernonSong"
header-img: "img/post-bg-gitignore.jpg"
catalog: true
tags:
    - git
---

做公司的项目，一直使用bitbucket，它跟github一样使用git版本控制系统，却可以免费的托管非开源项目。但使用SourceTree提交修改时经常提示文件大于10M，询问是否上传。看了看大于10M的文件，好像真的是些不需要上传的，但每次都剔除它们太麻烦，于是上网查了下有没有方便的解决办法，结果发现，git早就替我们想到了这些！

## .gitignore简介
在每个git管理的项目中，都默认有一个叫.gitignore的文件，它可以设定那些虽然在项目的目录中，但是不需要提交到服务器的文件和文件夹，通过合理的配置.gitignore，可以减少同步没用的文件和敏感的文件，加快了同步效率和安全性，也使被托管的项目不会变的杂乱。

乍一看这个文件可能会觉得很奇怪，怎么连个后缀名都没有。确实，这样的文件对Windows系统来说可能有些另类，但是其实创建这样的文件也很简单，只要新建一个文档，然后把名字（包括扩展名）改成.gitignore.就可以了，点确定后系统会自动删除后面那个.。

## .gitignore配置
.gitignore的配置应该遵循以下原则：

- 忽略操作系统自动生成的文件，比如缩略图等；
- 忽略编译生成的中间文件、可执行文件等，也就是如果一个文件是通过另一个文件自动生成的，那自动生成的文件就没必要放进版本库，比如Java编译产生的.class文件；
- 忽略你自己的带有敏感信息的配置文件，比如存放口令的配置文件。

比如，对于我的项目来说，需要忽略的主要是编译生成的各种文件，其次还有本地测试使用的图片，这些文件体积较大，并且无论是别人还是自己都没有必要同步这些文件到自己的进度中。

而配置忽略文件的语法，简单的说，是这样的：

- 以斜杠“/”开头表示目录
- 以星号“*”通配多个字符
- 以问号“?”通配单个字符
- 以方括号“[]”包含单个字符的匹配列表
- 以叹号“!”表示不忽略(跟踪)匹配到的文件或目录

详细的可以看[.gitignore官方文档](https://git-scm.com/docs/gitignore)。当然，对于我这种项目没什么特殊性，人有很懒的入门程序员来说，有一个更简单的方法，那就是使用github为我们编写好的[.gitignore模板](https://github.com/github/gitignore)，这些模板涵盖了常用的语言和编译器。比如我是用的VisualStudio.gitignore，它里面包含了VS编译器所编写的项目中所有可以忽略的文件，并且分门别类，写好注释，方便你根据自己的需求更改。简直业界良心，懒人福音！

## 遇到的问题
应用了编写好的.gitignore文件，上传修改却发现并没有忽略掉那些文件，原因是.gitignore只能忽略那些原来没有被track的文件，如果某些文件已经被纳入了版本管理中，则修改.gitignore是无效的。那么解决方法就是先把本地缓存删除（改变成未track状态），然后再提交：

使用命令行
git rm -r --cached

再看未暂存的文件，就会发现没有那些被忽略的文件了。